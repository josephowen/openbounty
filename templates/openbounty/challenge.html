{% extends "openbounty/base.html" %}
{% load comments %}

{% block title %}
Challenge
{% endblock title %}

{% block content %}
<div class="challenge">  
    <h1 class="title">{{challenge.title}}</h1>
    <div class="description"> {{challenge.challenge}}</div>
    <div class="expires"> {{challenge.expiration_date}}</div>
</div>

{% comment %}
{% render_comment_list for challenge %}
{% render_comment_form for challenge %}
{% endcomment %}

{% get_comment_list for challenge as list %}

{% for comment in list %}
    <div class="panel panel-default">
        <div class="panel-body">
            <strong>{{ comment.user }}</strong>
            {{ comment.comment }}
        </div>
    </div>
{% endfor %}

{% if user.is_authenticated %}
    {% get_comment_form for challenge as form %}
    <form action="{% comment_form_target %}" method="POST">
    {% csrf_token %}
    {{ form.comment }}
    {{ form.honeypot }}
    {{ form.content_type }}
    {{ form.object_pk }}
    {{ form.timestamp }}
    {{ form.security_hash }}
    <input type="submit" value="Add comment" id="id_submit" />
    <input type="hidden" name="next" value="{{ request.path }}" />
    </form>
{% else %}
    <p>Please <a href="{% url 'login' %}">log in</a> to leave a comment.</p>
{% endif %}

</div>
{% endblock content %}
